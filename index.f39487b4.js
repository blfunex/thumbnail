const e=document.getElementById("upload-drop-zone"),t=document.getElementById("upload-file-input"),n=document.getElementById("loading-filename"),a=document.getElementById("video"),o=document.getElementById("back-to-upload-button"),d=document.getElementById("video-time-range"),i=document.getElementById("video-time-input"),l=document.getElementById("video-duration-output"),r=document.getElementById("loading-progress"),u=document.getElementById("generate-thumbnail"),s=document.getElementById("thumbnail-image"),c=document.getElementById("thumbnail-download-link"),m=document.getElementById("back-to-video-button"),v=document.getElementById("thumbnail-new-button"),g=document.getElementById("upload-form"),f=document.createElement("canvas"),p=f.getContext("2d",{alpha:!1,desynchronized:!0,colorSpace:"srgb",willReadFrequently:!0}),E={upload:document.getElementById("upload-stage"),loading:document.getElementById("loading-stage"),video:document.getElementById("video-stage"),thumbnail:document.getElementById("thumbnail-stage")},h={close(){for(const e of Object.values(E))e.hidden=!0},show(e){this.close(),E[e].hidden=!1},tansition(e,t){E[e].hidden||(E[e].hidden=!0,E[t].hidden=!1)}};function L(){a.srcObject=null,g.reset(),h.show("upload")}function y(e){n.value=e.name,a.src=URL.createObjectURL(e),r.value=0,d.value="0",i.value="00:00",c.download=e.name.replace(/\.[^/.]+$/,""),h.show("loading")}function b(){const e=a.buffered.end(0);r.value=e/a.duration*100}function w(e){const t=(e=Math.ceil(e))%60,n=Math.floor(e/60),a=B(t);return`${B(n)}:${a}`}function B(e){return e.toString().padStart(2,"0")}function I(){i.value=w(a.currentTime)}function $(){R()}function k(e){const t=i.value,n=t.indexOf(":"),a=t.length;e?i.setSelectionRange(0,n):i.setSelectionRange(n+1,a)}function R(){const e=i.value.indexOf(":")+1,t=i.selectionStart;k(null===t||t<e)}function S(){const e=i.selectionStart,t=i.selectionEnd,[n,o]=i.value.split(":").map(parseFloat),d=60*n+o,l=A(0,a.duration,d);i.value=w(l),i.setSelectionRange(e,t)}function A(e,t,n){return Math.min(Math.max(n,e),t)}function D(){if(/^\d{0,3}:\d{0,2}$/.test(i.value))return S();const e=i.selectionStart,t=i.selectionEnd,n=/^\d{0,3}:[^:]*$/.test(i.value),o=/^[^:]*:\d{0,2}$/.test(i.value),d=i.value,[l,r]=w(a.currentTime).split(":"),u=n?d.split(":")[0]:l,s=o?d.split(":")[1]:r;i.value=`${u}:${s}`,i.setSelectionRange(e,t),S()}h.show("upload"),e.addEventListener("dragover",(t=>{t.preventDefault(),e.classList.add("drag-over")})),e.addEventListener("dragleave",(t=>{t.preventDefault(),e.classList.remove("drag-over")})),e.addEventListener("drop",(t=>{t.preventDefault(),e.classList.remove("drag-over");const n=t.dataTransfer?.files[0];n&&y(n)})),t.addEventListener("change",(e=>{const n=t.files?.[0];t.value="",t.blur(),n&&y(n)})),document.addEventListener("paste",(e=>{const t=e.clipboardData?.files?.[0];t&&!t.type.startsWith("video/")&&y(t)})),a.addEventListener("loadedmetadata",(()=>{a.addEventListener("progress",b),l.value=w(a.duration)})),a.addEventListener("canplaythrough",(()=>{a.removeEventListener("progress",b),h.tansition("loading","video"),a.loop=!0})),o.addEventListener("click",L),m.addEventListener("click",(()=>h.show("video"))),v.addEventListener("click",L),a.addEventListener("timeupdate",(()=>{!function(){const e=a.currentTime/a.duration;d.value=""+100*e}(),I()})),d.addEventListener("mousemove",(function(){document.activeElement===d&&function(){a.pause();const e=d.valueAsNumber/100;a.currentTime=a.duration*e,I()}()})),i.addEventListener("select",$),i.addEventListener("focus",$),i.addEventListener("click",$),i.addEventListener("blur",D),i.addEventListener("keypress",(e=>{O.includes(e.key)&&(e.preventDefault(),D())}));const O="0123456789".split(""),T=["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"];function U(e){if(!e)return;const t=URL.createObjectURL(e);s.src=t,c.href=t,h.show("thumbnail")}i.addEventListener("keydown",(e=>{if(!T.includes(e.key))return;e.preventDefault();const t=i.selectionStart,n=i.value,o=n.indexOf(":"),d=null===t||t<o,[l,r]=n.split(":").map(parseFloat),[u,s]=w(a.duration).split(":").map(parseFloat);switch(e.key){case"ArrowLeft":k(!0);break;case"ArrowRight":k(!1);break;case"ArrowUp":if(d){if(l===u)return;i.value=`${B(l+1)}:${B(r)}`,k(!0)}else{if(59===r)i.value=`${B(l+1)}:00`;else{if(l===u&&r===s)return;i.value=`${B(l)}:${B(r+1)}`}k(!1)}break;case"ArrowDown":if(d){if(0===l)return;i.value=`${B(l-1)}:${B(r)}`,k(!0)}else{if(0===r){if(0===l)return;i.value=`${B(l-1)}:59`}else i.value=`${B(l)}:${B(r-1)}`;k(!1)}}!function(){const e=i.value,[t,n]=e.split(":").map(parseFloat),o=60*t+n,d=A(0,a.duration,o);a.currentTime=d}()})),u.addEventListener("click",(function(){f.width=a.videoWidth,f.height=a.videoHeight,p.drawImage(a,0,0),f.toBlob(U)}));
//# sourceMappingURL=index.f39487b4.js.map
