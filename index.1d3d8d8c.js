const e=document.getElementById("upload-drop-zone"),t=document.getElementById("upload-file-input"),n=document.getElementById("loading-filename"),o=document.getElementById("video"),a=document.getElementById("back-to-upload-button"),d=document.getElementById("video-time-range"),i=document.getElementById("video-time-input"),l=document.getElementById("video-duration-output"),r=document.getElementById("loading-progress"),u=document.getElementById("generate-thumbnail"),s=document.getElementById("thumbnail-image"),c=document.getElementById("thumbnail-download-link"),m=document.getElementById("back-to-video-button"),v=document.getElementById("thumbnail-new-button"),g=document.getElementById("upload-form"),f=document.createElement("canvas"),p=f.getContext("2d",{alpha:!1,desynchronized:!0,colorSpace:"srgb",willReadFrequently:!0}),E={upload:document.getElementById("upload-stage"),loading:document.getElementById("loading-stage"),video:document.getElementById("video-stage"),thumbnail:document.getElementById("thumbnail-stage")},h={close(){for(const e of Object.values(E))e.hidden=!0},show(e){this.close(),E[e].hidden=!1},tansition(e,t){E[e].hidden||(E[e].hidden=!0,E[t].hidden=!1)}};function L(){o.srcObject=null,g.reset(),h.show("upload")}function y(e){n.value=e.name,o.src=URL.createObjectURL(e),r.value=0,d.value="0",i.value="00:00",c.download=e.name.replace(/\.[^/.]+$/,""),h.show("loading")}function b(){const e=o.buffered.end(0);r.value=e/o.duration*100}function w(e){const t=(e=Math.ceil(e))%60,n=Math.floor(e/60),o=B(t);return`${B(n)}:${o}`}function B(e){return e.toString().padStart(2,"0")}function I(){i.value=w(o.currentTime)}h.show("upload"),e.addEventListener("dragover",(t=>{t.preventDefault(),e.classList.add("drag-over")})),e.addEventListener("dragleave",(t=>{t.preventDefault(),e.classList.remove("drag-over")})),e.addEventListener("drop",(t=>{t.preventDefault(),e.classList.remove("drag-over");const n=t.dataTransfer?.files[0];n&&y(n)})),t.addEventListener("change",(e=>{const n=t.files?.[0];t.value="",t.blur(),n&&y(n)})),document.addEventListener("paste",(e=>{const t=e.clipboardData?.files?.[0];t&&!t.type.startsWith("video/")&&y(t)})),o.addEventListener("loadedmetadata",(()=>{o.addEventListener("progress",b),l.value=w(o.duration)})),o.addEventListener("canplaythrough",(()=>{o.removeEventListener("progress",b),h.tansition("loading","video"),o.loop=!0})),a.addEventListener("click",L),m.addEventListener("click",(()=>h.show("video"))),v.addEventListener("click",L),o.addEventListener("timeupdate",(()=>{!function(){const e=o.currentTime/o.duration;d.value=""+100*e}(),I()}));const $=F((function(){o.pause();const e=d.valueAsNumber/100;o.currentTime=o.duration*e,I()}),5);function k(){S()}function R(e){const t=i.value,n=t.indexOf(":"),o=t.length;e?i.setSelectionRange(0,n):i.setSelectionRange(n+1,o)}function S(){const e=i.value.indexOf(":")+1,t=i.selectionStart;R(null===t||t<e)}function A(){const e=i.selectionStart,t=i.selectionEnd,[n,a]=i.value.split(":").map(parseFloat),d=60*n+a,l=D(0,o.duration,d);i.value=w(l),i.setSelectionRange(e,t)}function D(e,t,n){return Math.min(Math.max(n,e),t)}function T(){if(/^\d{0,3}:\d{0,2}$/.test(i.value))return A();const e=i.selectionStart,t=i.selectionEnd,n=/^\d{0,3}:[^:]*$/.test(i.value),a=/^[^:]*:\d{0,2}$/.test(i.value),d=i.value,[l,r]=w(o.currentTime).split(":"),u=n?d.split(":")[0]:l,s=a?d.split(":")[1]:r;i.value=`${u}:${s}`,i.setSelectionRange(e,t),A()}d.addEventListener("mousemove",(function(){document.activeElement===d&&$()})),i.addEventListener("select",k),i.addEventListener("focus",k),i.addEventListener("click",k),i.addEventListener("blur",T),i.addEventListener("keypress",(e=>{O.includes(e.key)&&(e.preventDefault(),T())}));const O="0123456789".split(""),U=["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"];i.addEventListener("keydown",(e=>{if(!U.includes(e.key))return;e.preventDefault();const t=i.selectionStart,n=i.value,a=n.indexOf(":"),d=null===t||t<a,[l,r]=n.split(":").map(parseFloat),[u,s]=w(o.duration).split(":").map(parseFloat);switch(e.key){case"ArrowLeft":R(!0);break;case"ArrowRight":R(!1);break;case"ArrowUp":if(d){if(l===u)return;i.value=`${B(l+1)}:${B(r)}`,R(!0)}else{if(59===r)i.value=`${B(l+1)}:00`;else{if(l===u&&r===s)return;i.value=`${B(l)}:${B(r+1)}`}R(!1)}break;case"ArrowDown":if(d){if(0===l)return;i.value=`${B(l-1)}:${B(r)}`,R(!0)}else{if(0===r){if(0===l)return;i.value=`${B(l-1)}:59`}else i.value=`${B(l)}:${B(r-1)}`;R(!1)}}x()}));const x=F((function(){const e=i.value,[t,n]=e.split(":").map(parseFloat),a=60*t+n,d=D(0,o.duration,a);o.currentTime=d}),5);function F(e,t){let n;return()=>{clearTimeout(n),n=setTimeout(e,t)}}function j(e){if(!e)return;const t=URL.createObjectURL(e);s.src=t,c.href=t,h.show("thumbnail")}u.addEventListener("click",(function(){f.width=o.videoWidth,f.height=o.videoHeight,p.drawImage(o,0,0),f.toBlob(j)}));
//# sourceMappingURL=index.1d3d8d8c.js.map
